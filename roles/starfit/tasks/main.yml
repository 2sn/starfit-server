---
- name: Install dependencies
  dnf:
    name:
      - python
      - pip
      - python3-devel
      - python3-wheel
      - python3-ipython
      - python3-matplotlib
      - texlive
      - texlive-latex
      - texlive-type1cm
      - gfortran
    state: latest

- name: Install StarFit
  shell: pip install -i https://test.pypi.org/simple/ --extra-index-url https://pypi.org/simple/ starfit

- name: Add html content
  copy:
    src: html
    dest: /var/www/
    mode: preserve

- name: Create mount point
  file:
    path: /var/www/html/data
    state: directory
    mode: "0755"

- name: Ensure starfit data is mounted and served
  mount:
    src: LABEL=starfit-data
    path: /var/www/html/data
    fstype: ext4
    opts: defaults
    dump: 0
    passno: 2
    state: mounted
